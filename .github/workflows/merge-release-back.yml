# When a new push happens to a release-N branch,
# create a pull request merging the latest commit back to the `develop` branch.

---

on:
  push:
    branches: ['release-[0-9]+']

jobs:
  builld:
    runs-on: ubuntu-latest
    steps:
      - name: View the information
        run: |
          echo "commit ${{ github.event.after }}"
          echo "actor ${{ github.actor }}"
          echo "The username of the pusher: ${{ github.event.head_commit.author.username }}"
          echo "The name of the pusher: ${{ github.event.head_commit.author.name }}"
          echo "The email of the pusher: ${{ github.event.head_commit.author.email }}"

      - name: checkout develop branch
        uses: actions/checkout@v2
        ref: 'develop'

      - name: merge the release branch commit
        run: 'git merge ${{ github.event.after }}'

      - name: create new branch
        uses: peterjgrainger/action-create-branch@v2.0.1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          branch: 'merge-release-${{ github.event.after }}'
